var page=1;var hashbefore=window.location.hash;var nick_g="",search_g="",global_g=false;$(document).ready(function(){open();checkHash();$("a").live("click",function(){checkHash()});$("#more_twibbs").click(function(){reset_vars();load_dips(global_g,nick_g,search_g)})});$("#input_text").NobleCount("#counter",{on_negative:function(a,b,d,c){b.css("color","red")},on_positive:function(a,b,d,c){b.css("color","green")},max_chars:250,on_update:function(a,b,d,c){if(c<=10){b.css("color","red")}}});function dyn_get(b,d,a,c){if(d){$.get("api.php",{dyn_get:1,latest:b,page:page},function(e){$("#twibber").html(e)});return false}if(a!=""){$.get("api.php",{nick:a,latest:b,page:page},function(e){$("#twibber").html(e)});return false}if(c!=""){$.get("api.php",{search:c,latest:b,page:page},function(e){$("#twibber").html(e)});return false}return true}function dyn_submit(){var a=$("#input_text").val();if(a.replace(/^\s+|\s+$/g,"")!=""&&a.length<=250&&$("#nickname").val()!=""){$.post("api.php",{text:a,new_entry:1},function(b){dyn_get(true,true);$("#status").freeow(b,b.replace("!","")+" gesendet!",{classes:["smokey"],autoHideDelay:2500})});$("#input_text").val("");$("#counter").text("250")}else{alert("Error! Nachricht zu lang, keine Nachricht vorhanden oder kein Nickname eingegeben.")}}function insert_nick(a){$("#input_text").focus();$("#input_text").val("@"+a+" "+$("#input_text").val())}function open(){$("#open").click(function(){$("#panel").slideDown("slow").delay(1).css("display","block")});$("#close").click(function(){$("#panel").slideUp("slow")});$("#toggle a").click(function(){$("#toggle a").toggle()})}function load_dips(c,a,b){page++;$("#status").freeow("Loading","Neue Twibbs werden geladen!",{classes:["smokey"],autoHideDelay:2500});dyn_get(false,c,a,b)}function checkHash(){if(location.hash!=hashbefore){hashbefore=location.hash}var a=location.hash.replace(/#/g,"");a=a.split("=");switch(a[0]){case"nick":dyn_get(true,false,a[1]);nick_g=a[1];break;case"search":dyn_get(true,false,"",a[1]);search_g=a[1];break;default:interval=window.setInterval("dyn_get(true, true)",20000);global_g=true;break}}function reset_vars(){search_g="";global_g=false;nick_g=""};