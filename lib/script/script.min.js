var page=1;var nick_g="",search_g="",global_g=false,interval;window.onhashchange=checkHash(true);$(document).ready(function(){open();handleHash();$("#more_twibbs").click(function(){checkHash();load_dips(global_g,nick_g,search_g)});$(".twibb").live("mouseover mouseout",function(a){if(a.type=="mouseover"){$(this.children[3]).show()}if(a.type=="mouseout"){$(this.children[3]).hide()}});$("#logo > a > img").click(function(){dyn_get(true,true)});$(".comment_link").live("click",function(){$("#in_comment_to").html("in reply to: <a href='#' class='reply_to_link'>"+$(this).parents()[1].id+"</a>").show()});$(".reply_to_link").live("click",function(){$("#"+parseInt($(this).text())).css("border","5px solid yellow").delay(2000).css("border","0")})});$("#input_text").NobleCount("#counter",{on_negative:function(a,b,d,c){b.css("color","red")},on_positive:function(a,b,d,c){b.css("color","green")},max_chars:250,on_update:function(a,b,d,c){if(c<=10){b.css("color","red")}}});function dyn_get(b,d,a,c){if(d){$.get("api.php",{dyn_get:1,latest:b,page:page},function(e){$("#twibber").html(e)});return false}if(a!=""){$.get("api.php",{nick:a,latest:b,page:page},function(e){$("#twibber").html(e)});return false}if(c!=""){$.get("api.php",{search:c,latest:b,page:page},function(e){$("#twibber").html(e)});return false}return true}function dyn_submit(c){var d=$("#input_text").val();var b="api.php?new_entry=1";var a={text:d};if(c!=""){b="api.php?new_entry=1&comment=1";a={text:d,to_id:c}}if(d.replace(/^\s+|\s+$/g,"")!=""&&d.length<=250&&$("#nickname").val()!=""){$.post(b,a,function(e){dyn_get(true,true);$("#status").freeow(e,e.replace("!","")+" gesendet!",{classes:["smokey"],autoHideDelay:2500})});$("#input_text").val("");$("#counter").text("250");$("#in_reply_to").html("")}else{alert("Error! Nachricht zu lang, keine Nachricht vorhanden oder kein Nickname eingegeben.")}}function insert_nick(a){$("#input_text").focus();$("#input_text").val("@"+a+" "+$("#input_text").val())}function open(){$("#open").click(function(){$("#panel").slideDown("slow").delay(1).css("display","block")});$("#close").click(function(){$("#panel").slideUp("slow")});$("#toggle a").click(function(){$("#toggle a").toggle()})}function load_dips(c,a,b){page++;$("#status").freeow("Loading","Mehr Twibbs werden geladen!",{classes:["smokey"],autoHideDelay:2500});dyn_get(false,c,a,b)}function handleHash(){if(interval!=undefined){window.clearInterval(interval)}var a=checkHash();switch(a[0]){case"nick":$("#status").freeow("Loading","Twibbs von "+a[1]+" werden geladen",{classes:["smokey"],autoHideDelay:1500});dyn_get(true,false,a[1]);break;case"search":$("#status").freeow("Loading","Twibbs werden gesucht ("+a[1]+")",{classes:["smokey"],autoHideDelay:1500});dyn_get(true,false,"",a[1]);break;default:interval=window.setInterval("dyn_get(true, true)",20000);break}}function checkHash(a){reset_vars();if(location.hash!=hash_before){hash_before=location.hash;if(a){handleHash()}}var b=location.hash.replace("#","");b=b.split("=");switch(b[0]){case"nick":nick_g=b[1];break;case"search":search_g=b[1];break;default:global_g=true;break}return b}function reset_vars(){search_g="";global_g=false;nick_g=""};