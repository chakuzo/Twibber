var page=1;var hash_before=window.location.hash;var nick_g="",search_g="",global_g=false,interval;$(document).ready(function(){open();handleHash();interval2=window.setInterval("checkHash(true)",100);$("#more_twibbs").click(function(){checkHash();load_dips(global_g,nick_g,search_g)});$("#logo > a > img").click(function(){dyn_get(true,true)})});$("#input_text").NobleCount("#counter",{on_negative:function(a,b,d,c){b.css("color","red")},on_positive:function(a,b,d,c){b.css("color","green")},max_chars:250,on_update:function(a,b,d,c){if(c<=10){b.css("color","red")}}});function dyn_get(b,d,a,c){if(d){$.get("api.php",{dyn_get:1,latest:b,page:page},function(e){$("#twibber").html(e)});return false}if(a!=""){$.get("api.php",{nick:a,latest:b,page:page},function(e){$("#twibber").html(e)});return false}if(c!=""){$.get("api.php",{search:c,latest:b,page:page},function(e){$("#twibber").html(e)});return false}return true}function dyn_submit(){var a=$("#input_text").val();if(a.replace(/^\s+|\s+$/g,"")!=""&&a.length<=250&&$("#nickname").val()!=""){$.post("api.php?new_entry=1",{text:a},function(b){dyn_get(true,true);$("#status").freeow(b,b.replace("!","")+" gesendet!",{classes:["smokey"],autoHideDelay:2500})});$("#input_text").val("");$("#counter").text("250")}else{alert("Error! Nachricht zu lang, keine Nachricht vorhanden oder kein Nickname eingegeben.")}}function insert_nick(a){$("#input_text").focus();$("#input_text").val("@"+a+" "+$("#input_text").val())}function open(){$("#open").click(function(){$("#panel").slideDown("slow").delay(1).css("display","block")});$("#close").click(function(){$("#panel").slideUp("slow")});$("#toggle a").click(function(){$("#toggle a").toggle()})}function load_dips(c,a,b){page++;$("#status").freeow("Loading","Mehr Twibbs werden geladen!",{classes:["smokey"],autoHideDelay:2500});dyn_get(false,c,a,b)}function handleHash(){if(interval!=undefined){window.clearInterval(interval)}var a=checkHash();switch(a[0]){case"nick":$("#status").freeow("Loading","Twibbs von "+a[1]+" werden geladen",{classes:["smokey"],autoHideDelay:1500});dyn_get(true,false,a[1]);break;case"search":$("#status").freeow("Loading","Twibbs werden gesucht ("+a[1]+")",{classes:["smokey"],autoHideDelay:1500});dyn_get(true,false,"",a[1]);break;default:interval=window.setInterval("dyn_get(true, true)",20000);break}}function checkHash(a){reset_vars();if(location.hash!=hash_before){hash_before=location.hash;if(a){handleHash()}}var b=location.hash.replace("#","");b=b.split("=");switch(b[0]){case"nick":nick_g=b[1];break;case"search":search_g=b[1];break;default:global_g=true;break}return b}function reset_vars(){search_g="";global_g=false;nick_g=""};